{
  "_comment": "Syslog / journald — journald ISO 8601 format (no PRI prefix)",
  "id": "syslog",
  "name": "Syslog / Journald",

  "detect": {
    "filename_keywords": ["syslog", "auth", "kern", "daemon", "messages", "journal"],
    "_comment": "Matches ISO 8601 with fractional seconds+TZ (journald), bare ISO (other), or classic BSD Mmm DD HH:MM:SS",
    "content_regex": "(?:^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}[.\\d]*(?:Z|[+-]\\d{2}:\\d{2})|^\\w{3}[ \\t]+\\d{1,2}[ \\t]+\\d{2}:\\d{2}:\\d{2})"
  },

  "fields": [
    {
      "_comment": "Captures full ISO 8601 timestamp including optional fractional seconds and timezone offset or Z",
      "type": "timestamp",
      "dtype": "timestamp",
      "regex": "^(\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?(?:Z|[+-]\\d{2}:\\d{2})?|\\w{3}[ \\t]+\\d{1,2}[ \\t]+\\d{2}:\\d{2}:\\d{2})"
    },
    {
      "_comment": "Hostname is the second whitespace-delimited token after the timestamp",
      "type": "hostname",
      "dtype": "text",
      "regex": "^\\S+[ \\t]+(\\S+)[ \\t]+\\S",
      "filterable": true
    },
    {
      "_comment": "Service/process name — the TAG in RFC 3164 terms, with optional [pid] stripped. Anchored to the token immediately followed by [ or : to avoid false matches in message body.",
      "type": "service",
      "dtype": "text",
      "regex": "^\\S+[ \\t]+\\S+[ \\t]+([a-zA-Z][\\w./:-]{0,47})(?:\\[\\d+\\])?:",
      "filterable": true
    },
    {
      "type": "ip",
      "dtype": "text",
      "regex": "\\b((?:\\d{1,3}\\.){3}\\d{1,3})\\b",
      "multi": true,
      "filterable": true
    },
    {
      "_comment": "Error-level message text, only collected for error-classified lines",
      "type": "message",
      "dtype": "text",
      "regex": "\\w+(?:\\[\\d+\\])?:[ \\t]+(.+)$",
      "error_levels": ["error"]
    }
  ],

  "level_rules": [
    {"regex": "\\b(CRITICAL|FATAL|EMERG|ALERT|CRIT|ERROR|ERR|DENIED|FAILED|FAILURE)\\b", "level": "error", "flags": "i"},
    {"regex": "\\b(WARNING|WARN)\\b",      "level": "warn",  "flags": "i"},
    {"regex": "\\b(NOTICE|INFO|ALLOWED)\\b","level": "info",  "flags": "i"},
    {"regex": "\\b(DEBUG|TRACE)\\b",       "level": "debug", "flags": "i"}
  ],

  "highlights": [
    {"regex": "^\\d{4}-\\d{2}-\\d{2}T[\\d:.+Z-]+",             "attr": "lno"},
    {"regex": "\\b(CRITICAL|FATAL|EMERG|ALERT|ERROR|ERR)\\b",   "attr": "he",  "flags": "i"},
    {"regex": "apparmor=\"DENIED\"",                             "attr": "he",  "flags": "i"},
    {"regex": "\\b(FAILED|FAILURE|DENIED)\\b",                  "attr": "he",  "flags": "i"},
    {"regex": "\\b(WARNING|WARN)\\b",                           "attr": "hw",  "flags": "i"},
    {"regex": "\\b(NOTICE|INFO|ALLOWED)\\b",                    "attr": "hi",  "flags": "i"},
    {"regex": "apparmor=\"ALLOWED\"",                            "attr": "hi",  "flags": "i"},
    {"regex": "\\b(DEBUG|TRACE)\\b",                            "attr": "hd",  "flags": "i"},
    {"regex": "\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b",              "attr": "hip"},
    {"regex": "[a-zA-Z_]\\w*=\"[^\"]*\"",                       "attr": "hd"},
    {"regex": "\\baudit\\([\\.\\d:]+\\)",                        "attr": "lno"}
  ]
}