{
  "_comment": "Syslog / journald â€” traditional Unix system logs",
  "id": "syslog",
  "name": "Syslog / Journald",

  "detect": {
    "filename_keywords": ["syslog", "auth", "kern", "daemon", "messages", "journal"],
    "content_regex": "(?:^\\w{3}\\s+\\d+\\s+\\d{2}:\\d{2}:\\d{2}\\s|^\\d{4}-\\d{2}-\\d{2}T)"
  },

  "fields": [
    {
      "type": "timestamp",
      "dtype": "timestamp",
      "regex": "^(\\S+T\\d{2}:\\d{2}:\\d{2}|\\w{3}\\s+\\d+\\s+\\d{2}:\\d{2}:\\d{2})"
    },
    {
      "type": "service",
      "dtype": "text",
      "regex": "^\\S+\\s+\\S+\\s+(\\S+?)(?:\\[\\d+\\])?:",
      "filterable": true
    },
    {
      "type": "ip",
      "label": "IP",
      "dtype": "text",
      "regex": "\\b((?:\\d{1,3}\\.){3}\\d{1,3})\\b",
      "multi": true,
      "filterable": true
    },
    {
      "type": "message",
      "dtype": "text",
      "regex": "\\w+(?:\\[\\d+\\])?:\\s+(.+)$",
      "error_levels": ["error"]
    }
  ],

  "level_rules": [
    {"regex": "\\b(CRITICAL|FATAL|ERROR|ERR)\\b", "level": "error", "flags": "i"},
    {"regex": "\\b(WARNING|WARN)\\b",              "level": "warn",  "flags": "i"},
    {"regex": "\\b(NOTICE|INFO)\\b",               "level": "info",  "flags": "i"},
    {"regex": "\\b(DEBUG|TRACE)\\b",               "level": "debug", "flags": "i"}
  ],

  "highlights": [
    {"regex": "\\b(CRITICAL|FATAL|ERROR|ERR)\\b",  "attr": "he",  "flags": "i"},
    {"regex": "\\b(WARNING|WARN)\\b",               "attr": "hw",  "flags": "i"},
    {"regex": "\\b(NOTICE|INFO)\\b",                "attr": "hi",  "flags": "i"},
    {"regex": "\\b(DEBUG|TRACE)\\b",                "attr": "hd",  "flags": "i"},
    {"regex": "\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b",  "attr": "hip"}
  ]
}
